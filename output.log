Старков Савва 3343

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date
Fri 07 Mar 2025 04:52:01 AM MSK
vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && whoami
Fri 07 Mar 2025 04:52:37 AM MSK
vboxuser
vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && lscpu
Fri 07 Mar 2025 04:52:45 AM MSK
Architecture:             x86_64
  CPU op-mode(s):         32-bit, 64-bit
  Address sizes:          48 bits physical, 48 bits virtual
  Byte Order:             Little Endian
CPU(s):                   6
  On-line CPU(s) list:    0-5
Vendor ID:                AuthenticAMD
  Model name:             AMD Ryzen 7 5800H with Radeon Graphics
    CPU family:           25
    Model:                80
    Thread(s) per core:   1
    Core(s) per socket:   6
    Socket(s):            1
    Stepping:             0
    BogoMIPS:             6387.77
    Flags:                fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx mm
                          xext fxsr_opt rdtscp lm constant_tsc rep_good nopl nonstop_tsc cpuid extd_apicid tsc_known_freq pni pclmulqdq ssse
                          3 cx16 sse4_1 sse4_2 movbe popcnt aes rdrand hypervisor lahf_lm cmp_legacy cr8_legacy abm sse4a misalignsse 3dnowp
                          refetch vmmcall fsgsbase bmi1 bmi2 invpcid rdseed adx clflushopt sha_ni arat
Virtualization features:  
  Hypervisor vendor:      KVM
  Virtualization type:    full
Caches (sum of all):      
  L1d:                    192 KiB (6 instances)
  L1i:                    192 KiB (6 instances)
  L2:                     3 MiB (6 instances)
  L3:                     96 MiB (6 instances)
NUMA:                     
  NUMA node(s):           1
  NUMA node0 CPU(s):      0-5
Vulnerabilities:          
  Gather data sampling:   Not affected
  Itlb multihit:          Not affected
  L1tf:                   Not affected
  Mds:                    Not affected
  Meltdown:               Not affected
  Mmio stale data:        Not affected
  Reg file data sampling: Not affected
  Retbleed:               Not affected
  Spec rstack overflow:   Mitigation; safe RET
  Spec store bypass:      Not affected
  Spectre v1:             Mitigation; usercopy/swapgs barriers and __user pointer sanitization
  Spectre v2:             Mitigation; Retpolines; STIBP disabled; RSB filling; PBRSB-eIBRS Not affected; BHI Not affected
  Srbds:                  Not affected
  Tsx async abort:        Not affected



vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && systemd-detect-virt
Sun 09 Mar 2025 06:28:11 PM MSK
oracle


vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && uname -a
Sun 09 Mar 2025 06:28:36 PM MSK
Linux vbox 6.1.0-31-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.128-1 (2025-02-07) x86_64 GNU/Linux


vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && ls -l | grep '^-' | head -n 1
Sun 09 Mar 2025 06:32:27 PM MSK
-rwxr-xr-x 1 root     root     16296 Mar  7 01:54 gateway

vboxuser@vbox:/dev$ date && ls -l | grep '^b' | head -n 1
Sun 09 Mar 2025 06:33:37 PM MSK
brw-rw----  1 root     disk      7,   0 Mar  5 10:30 loop0

vboxuser@vbox:/$ date && ls -lR | grep '^c' | head -n 1
Sun 09 Mar 2025 06:33:57 PM MSK
crw-r--r--  1 root     root     10, 235 Mar  5 10:30 autofs

vboxuser@vbox:/$ date && ls -l | grep '^d' | head -n 1
Sun 09 Mar 2025 06:35:25 PM MSK
drwxr-xr-x   3 root root  4096 Feb 27 20:15 boot

vboxuser@vbox:/run$ date && ls -l | grep '^l' | head -n 1
Sun 09 Mar 2025 06:36:07 PM MSK
lrwxrwxrwx  1 root              root          8 Mar  5 10:30 shm -> /dev/shm

vboxuser@vbox:/run$ date && ls -l | grep '^p' | head -n 1
Sun 09 Mar 2025 06:36:29 PM MSK
prw-------  1 root              root          0 Mar  5 10:30 initctl

vboxuser@vbox:/run$ date && ls -l | grep '^s' | head -n 1
Sun 09 Mar 2025 06:36:58 PM MSK
srw-rw----  1 root              docker        0 Mar  5 10:30 docker.sock

1) 

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && bash task1.sh output.txt && cat output.txt
Sun 09 Mar 2025 06:38:34 PM MSK
Результаты сохранены в: output.txt
-rw-r--r-- 1 root root   259624 Jan  2 16:31 config-6.1.0-29-amd64 -/config-6.1.0-29-amd64
brw-rw----  1 root     disk      7,   0 Mar  5 10:30 loop0 -/loop0
crw-r--r--  1 root     root     10, 235 Mar  5 10:30 autofs -/autofs
drwxr-xr-x   3 root root  4096 Feb 27 20:15 boot -/boot
lrwxrwxrwx   1 root root     7 Feb 21 00:39 bin -> usr/bin -/usr/bin
prw-------  1 root              root          0 Mar  5 10:30 initctl -/initctl
srw-rw----  1 root              docker        0 Mar  5 10:30 docker.sock -/docker.sock

2) 

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && ln output.txt ./example/output.txt 
Sun 09 Mar 2025 06:49:48 PM MSK

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && bash task2.sh output.txt
Sun 09 Mar 2025 06:51:11 PM MSK
39960 -rw-r--r-- 2 vboxuser vboxuser   518 Mar  9 18:38 output.txt
39960 -rw-r--r-- 2 vboxuser vboxuser 518 Mar  9 18:38 output.txt

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ cp -s output.txt  link_cp.txt
vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ ln -s output.txt  link_ln.txt
vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && bash task3.sh output.txt
Sun 09 Mar 2025 06:56:09 PM MSK
Результаты сохранены в out.txt
Найдено ссылок: 2
lrwxrwxrwx 1 vboxuser vboxuser    10 Mar  9 18:55 link_cp.txt -> output.txt
lrwxrwxrwx 1 vboxuser vboxuser    10 Mar  9 18:55 link_ln.txt -> output.txt
total 2

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && ls -li
Sun 09 Mar 2025 06:57:10 PM MSK
total 72
39890 drwxr-xr-x 2 vboxuser vboxuser  4096 Mar  9 18:49 example
 5737 -rwxr-xr-x 1 root     root     16296 Mar  7 01:54 gateway
14501 -rwsr-xr-x 1 testuser vboxuser   949 Mar  7 01:49 gateway.c
39936 lrwxrwxrwx 1 vboxuser vboxuser    10 Mar  9 18:55 link_cp.txt -> output.txt
40027 lrwxrwxrwx 1 vboxuser vboxuser    10 Mar  9 18:55 link_ln.txt -> output.txt
39906 -rw-r--r-- 1 vboxuser vboxuser   132 Mar  9 18:51 out2.txt
 5688 -rw-r--r-- 1 vboxuser vboxuser  5470 Mar  9 18:56 output.log
39960 -rw-r--r-- 2 vboxuser vboxuser   518 Mar  9 18:38 output.txt
40011 -rw-r--r-- 1 vboxuser vboxuser   160 Mar  9 18:56 out.txt
 1114 -rwxr-xr-x 1 vboxuser vboxuser  1758 Mar  7 02:00 gateway.sh
 1078 -rw-r--r-- 1 vboxuser vboxuser  1155 Mar  6 02:55 task1.sh
 1070 -rw-r--r-- 1 vboxuser vboxuser   187 Mar  6 10:33 task2.sh
 1105 -rw-r--r-- 1 vboxuser vboxuser   863 Mar  6 06:18 task3.sh
 1228 -rw-r--r-- 1 vboxuser vboxuser  1125 Mar  6 20:47 task7.sh
 1095 -rw-r--r-- 1 vboxuser vboxuser   836 Mar  6 21:12 task8.sh
14481 -rw-r--r-- 1 vboxuser vboxuser  3067 Mar  6 23:28 task91.sh

4)

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && ls -lR ~ | grep "^l" | grep "\-> output.txt"
Sun 09 Mar 2025 06:58:33 PM MSK
lrwxrwxrwx 1 vboxuser vboxuser    10 Mar  9 18:55 link_cp.txt -> output.txt
lrwxrwxrwx 1 vboxuser vboxuser    10 Mar  9 18:55 link_ln.txt -> output.txt

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && find ~ -type l -exec stat -c "%N" {} +  | grep -w "output.txt" 
Sun 09 Mar 2025 06:59:11 PM MSK
'/home/vboxuser/snap/code/184/.local/share/Trash/files/examples/link_ln.txt' -> 'output.txt'
'/home/vboxuser/Documents/Starkov_Savva_lb1/link_ln.txt' -> 'output.txt'
'/home/vboxuser/Documents/Starkov_Savva_lb1/link_cp.txt' -> 'output.txt'

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && find ~ -type l -lname "output.txt"
Sun 09 Mar 2025 06:59:55 PM MSK
/home/vboxuser/snap/code/184/.local/share/Trash/files/examples/link_ln.txt
/home/vboxuser/Documents/Starkov_Savva_lb1/link_ln.txt
/home/vboxuser/Documents/Starkov_Savva_lb1/link_cp.txt

5)

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && find . -type f -ls 2>error.log  | head -n 1
Sun 09 Mar 2025 07:02:04 PM MSK
     5737     16 -rwxr-xr-x   1 root     root        16296 Mar  7 01:54 ./gateway

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && find /dev -type l -ls  | head -n 1
Sun 09 Mar 2025 07:02:49 PM MSK
      799      0 lrwxrwxrwx   1 root     root            3 Mar  7 03:50 /dev/cdrom -> sr0

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && find /dev -type b -ls  | head -n 1
Sun 09 Mar 2025 07:03:25 PM MSK
      327      0 brw-rw----   1 root     disk       7,   7 Mar  5 10:30 /dev/loop7

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && find /dev -type c -ls  | head -n 1
Sun 09 Mar 2025 07:03:46 PM MSK
      816      0 crw-------   1 root     root     246,   0 Mar  7 04:41 /dev/hidraw0

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && find /dev -type d -ls  | head -n 1
Sun 09 Mar 2025 07:04:06 PM MSK
        1      0 drwxr-xr-x  18 root     root         3340 Mar  7 04:41 /dev

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && find /run -type p -ls 2>error.log  | head -n 1
Sun 09 Mar 2025 07:04:47 PM MSK
       76      0 prw-r--r--   1 vboxuser vboxuser        0 Mar  5 10:31 /run/user/1000/gnome-session-leader-fifo

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && find /run -type s -ls 2>error.log  | head -n 1
Sun 09 Mar 2025 07:05:07 PM MSK
      960      0 srw-rw-rw-   1 root     root            0 Mar  5 10:30 /run/snapd-snap.socket

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && find . -type l -exec ls -l {} +
Sun 09 Mar 2025 07:05:26 PM MSK
lrwxrwxrwx 1 vboxuser vboxuser 10 Mar  9 18:55 ./link_cp.txt -> output.txt
lrwxrwxrwx 1 vboxuser vboxuser 10 Mar  9 18:55 ./link_ln.txt -> output.txt

6)

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && cat hello.txt
Sun 09 Mar 2025 07:14:49 PM MSK
Hello World!

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && od -tx1 -Ax hello.txt
Sun 09 Mar 2025 07:15:06 PM MSK
000000 48 65 6c 6c 6f 20 57 6f 72 6c 64 21 21
00000d
vboxuser@vbox:~/Documents/Starkov_Savva_lb1$  date && hexdump -C hello.txt
Sun 09 Mar 2025 07:15:30 PM MSK
00000000  48 65 6c 6c 6f 20 57 6f  72 6c 64 21 21           |Hello World!!|
0000000d

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && hexdump -C test
Sun 09 Mar 2025 07:16:10 PM MSK
hexdump: test: Is a directory

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && hexdump -C test
Sun 09 Mar 2025 07:16:40 PM MSK
hexdump: test: Is a directory

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && hexdump -C test
Sun 09 Mar 2025 07:16:53 PM MSK
hexdump: test: Is a directory


vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && od -tx1 -Ax test
Sun 09 Mar 2025 07:17:20 PM MSK
od: test: Is a directory
000000

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && od -tx1 -tc test.gif | head -n 
10
Sun 09 Mar 2025 07:19:37 PM MSK
0000000  47  49  46  38  39  61  90  06  98  03  f7  00  00  05  05  05
          G   I   F   8   9   a 220 006 230 003 367  \0  \0 005 005 005
0000020  14  14  14  19  19  19  1d  1d  1d  1d  1e  1e  1e  1e  1e  1e
        024 024 024 031 031 031 035 035 035 035 036 036 036 036 036 036
0000040  1e  1f  1f  1f  1f  1d  1e  27  1d  20  1f  1d  29  28  2a  1e
        036 037 037 037 037 035 036   ' 035     037 035   )   (   * 036
0000060  1e  34  25  1e  21  21  21  23  23  26  22  24  21  24  27  22
        036   4   % 036   !   !   !   #   #   &   "   $   !   $   '   "
0000100  24  24  24  25  25  26  26  26  25  26  26  26  26  26  28  25
          $   $   $   %   %   &   &   &   %   &   &   &   &   &   (   %

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && hexdump -C test.png | head -n 1
0
Sun 09 Mar 2025 07:20:03 PM MSK
00000000  89 50 4e 47 0d 0a 1a 0a  00 00 00 0d 49 48 44 52  |.PNG........IHDR|
00000010  00 00 02 00 00 00 02 00  08 06 00 00 00 f4 78 d4  |..............x.|
00000020  fa 00 00 00 04 73 42 49  54 08 08 08 08 7c 08 64  |.....sBIT....|.d|
00000030  88 00 00 00 09 70 48 59  73 00 00 0e c4 00 00 0e  |.....pHYs.......|
00000040  c4 01 95 2b 0e 1b 00 00  00 19 74 45 58 74 53 6f  |...+......tEXtSo|
00000050  66 74 77 61 72 65 00 77  77 77 2e 69 6e 6b 73 63  |ftware.www.inksc|
00000060  61 70 65 2e 6f 72 67 9b  ee 3c 1a 00 00 20 00 49  |ape.org..<... .I|
00000070  44 41 54 78 9c ec dd 77  7c 5b d7 79 ff f1 0f 36  |DATx...w|[.y...6|
00000080  08 70 00 dc 7b 89 d4 16  25 52 24 65 59 8e 2d ef  |.p..{...%R$eY.-.|
00000090  15 3b 8e 9d bd 93 ce 24  6d 93 b6 19 4d d2 95 d5  |.;.....$m...M...|

7)

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && bash task7.sh
Sun 09 Mar 2025 07:20:46 PM MSK
Создан каталог: test_dir
=== Начальный размер ===
Текущий размер каталога: 4.0K

=== Добавляем 5 файлов по 1 МБ ===
Текущий размер каталога: 5.1M

=== Удаляем 3 файла ===
Текущий размер каталога: 2.1M

=== Добавляем 100 пустых файлов ===
Текущий размер каталога: 2.1M

=== Очищаем каталог ===
Текущий размер каталога: 4.0K

8)

vboxuser@vbox:/etc$ date && cat passwd | head -n 4
Пн 09 мар 2025 19:46:20 MSK
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
vboxuser@vbox:/etc$ date && cat shadow
Пн 09 мар 2025 19:46:29 MSK
cat: shadow: Отказано в доступе
vboxuser@vbox:/etc$ 

vboxuser@vbox:/etc$ date && sudo cat shadow | head -n 4
Пн 09 мар 2025 19:46:50 MSK
[sudo] пароль для vboxuser: 
root:*:19962:0:99999:7:::
daemon:*:19962:0:99999:7:::
bin:*:19962:0:99999:7:::
sys:*:19962:0:99999:7:::

vboxuser@vbox:/etc$ date && ls -l passwd
Пн 09 мар 2025 19:48:46 MSK
-rw-r--r-- 1 root root 2903 фев 13 23:18 passwd
vboxuser@vbox:/etc$ date && ls -l shadow
Пн 09 мар 2025 19:48:50 MSK
-rw-r----- 1 root shadow 1359 фев 13 23:18 shadow

vboxuser@vbox:/$ date && usr/bin/passwd
Пн 09 мар 2025 19:50:06 MSK
Смена пароля для vboxuser.
Текущий пароль: 
Новый пароль: 
Повторите ввод нового пароля: 
passwd: пароль успешно обновлён

9)

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && bash task91.sh 
Sun 09 Mar 2025 07:26:38 PM MSK

[9.1] Примеры chmod и chown
Исходные права:
Текущие права:
total 12
-rw-r--r-- 1 vboxuser vboxuser    0 Mar  9 19:26 file.txt
-rw-r--r-- 1 vboxuser vboxuser   13 Mar  9 19:26 secret.txt
-rwxr-xr-x 1 vboxuser vboxuser   42 Mar  9 19:26 suid_script.sh
drwxr-xr-x 2 vboxuser vboxuser 4096 Mar  9 19:26 test_folder
--------------------------------
После chmod 755 file.txt:
Текущие права:
total 12
-rwxr-xr-x 1 vboxuser vboxuser    0 Mar  9 19:26 file.txt
-rw-r--r-- 1 vboxuser vboxuser   13 Mar  9 19:26 secret.txt
-rwxr-xr-x 1 vboxuser vboxuser   42 Mar  9 19:26 suid_script.sh
drwxr-xr-x 2 vboxuser vboxuser 4096 Mar  9 19:26 test_folder
--------------------------------
После chmod u=rwx,g=rx,o= test_folder:
Текущие права:
total 12
-rwxr-xr-x 1 vboxuser vboxuser    0 Mar  9 19:26 file.txt
-rw-r--r-- 1 vboxuser vboxuser   13 Mar  9 19:26 secret.txt
-rwxr-xr-x 1 vboxuser vboxuser   42 Mar  9 19:26 suid_script.sh
drwxr-x--- 2 vboxuser vboxuser 4096 Mar  9 19:26 test_folder
--------------------------------
[sudo] password for vboxuser: 
Sorry, try again.
[sudo] password for vboxuser: 
После chown nobody file.txt:
Текущие права:
total 12
-rwxr-xr-x 1 nobody   vboxuser    0 Mar  9 19:26 file.txt
-rw-r--r-- 1 vboxuser vboxuser   13 Mar  9 19:26 secret.txt
-rwxr-xr-x 1 vboxuser vboxuser   42 Mar  9 19:26 suid_script.sh
drwxr-x--- 2 vboxuser vboxuser 4096 Mar  9 19:26 test_folder
--------------------------------

[9.2] Установка SUID
Права с SUID:
-rwsr-xr-x 1 vboxuser vboxuser 42 Mar  9 19:26 suid_script.sh
Проверка SUID:
-rwsr-xr-x 1 vboxuser vboxuser 42 Mar  9 19:26 suid_script.sh

[9.3] Эксперимент с разными правами
Права special.txt:
-rwxr-x--- 1 testuser testgroup 0 Mar  9 19:26 special.txt

Проверка доступа:
От владельца (testuser):
-rwxr-x--- 1 testuser testgroup 0 Mar  9 19:26 special.txt

От члена группы (текущий пользователь):
-rwxr-x--- 1 testuser testgroup 0 Mar  9 19:26 special.txt
  cat: special.txt: Permission denied

[9.4] Права каталога vs права файла

Случай 1: Каталог rx, файл rw
Попытка чтения файла:

Случай 2: Каталог --x, файл rw
Попытка просмотра каталога:
  total 0
  -rw------- 1 vboxuser vboxuser 0 Mar  9 19:26 inside.txt
Попытка чтения файла:

Тестовая среда удалена. Все изменения отменены.


10)

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && echo "Secret data" >> secret.txt
Пн 09 мар 2025 19:33:05 MSK

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && sudo chmod 600 secret.txt && ls -l examples/secret.txt 
Пн 09 мар 2025 19:33:08 MSK
-rw------- 1 vboxuser vboxuser 12 мар  3 22:15 secret.txt

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && sudo su testuser 
Пн 09 мар 2025 19:34:27 MSK
$ date && whoami
Пн 09 мар 2025 19:35:38 MSK
testuser
$ date && cat secret.txt
Пн 09 мар 2025 19:35:48 MSK
cat: secret.txt: Отказано в доступе

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && gcc gateway.c -o gateway
Пн 09 мар 2025 19:35:49 MSK

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && sudo chown vboxuser:vboxuser gateway && chmod 4755 gateway
Пн 09 мар 2025 19:35:50 MSK
[sudo] пароль для vboxuser:

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ date && ls -l gateway
Пн 09 мар 2025 19:35:55 MSK
-rwsr-xr-x 1 vboxuser vboxuser 16144 мар  3 22:19 gateway

vboxuser@vbox:~/Documents/Starkov_Savva_lb1$ sudo su testuser 
$ gateway
sh: 1: gateway: not found
$ ./gateway
Secret data
$ date && ./gateway && whoami
Пн 09 мар 2025 19:36:17 MSK
Secret data
testuser